---
title: 'Statistics 305: Introduction to Biostatistical Methods for Health Sciences'
subtitle: 'R Demo for Chapters 2 and 3: Data presentations and summaries'
author: "Jinko Graham"
date: '2018-09-01'
output: 
  beamer_presentation:
    includes:
      in_header: ../header_pagenum.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Note on Slides

## Demo Slides

* This document shows and explains the R commands
used to create the data summaries of the Chapters 2 and 3
lecture slides. 
    + For brevity, I omit slides and remarks that do not pertain
    to computations done in R.
* This document should be read **after** reading the lecture slides.
* You may find the R commands in this demo useful for 
your homework assignments.

# Data Presentation (Chapter 2)

## Tables

* Tables can be used to display the frequency distribution of a 
categorical variable 
* Example: Frequency distribution of gender among 
21,737 bladder cancer patients. Data from [Mungan et al. (2000)](https://www.ncbi.nlm.nih.gov/pubmed/10699612)

\scriptsize

```{r,echo=TRUE}
uu <- url("http://people.stat.sfu.ca/~jgraham/Teaching/S305_17/Data/mung.csv")
Mungan <- read.csv(uu)
head(Mungan)
with(Mungan,table(Gender))
```

## Software Notes: Reading Data Into R

* `read.csv()` reads comma-separated-value (CSV) files into R.
    + By default it reads files from the "working" directory
    in which R is running (e.g., the folder of
    your Jupyter notebook), but
    it can read files from URLs too.
    + The `url()` function takes a quoted URL as input and
    returns an object that `read.csv()` can use to fetch
    the file.
* `read.table()` is a more flexible function for reading 
tabular data into R; e.g.,

\scriptsize

```{r}
uu <- url("http://people.stat.sfu.ca/~jgraham/Teaching/S305_17/Data/mung.csv")
Mungan <- read.table(uu,header=TRUE,sep=",")
```

\small

* `read.table()` options include the following (type `help("read.table")` into R for a full list):
    + `header` (default `FALSE`): Does the first line of 
    the file contain the variable names?
    + `sep` (default "", for blank spaces)

## Software Notes: `head()`,`with()` and `table()`

* The `head()` function looks at the first few rows
(default is six) of a dataset.
    + In the example, the dataset is called `Mungan`, 
    having variables `Gender` and `Cancer.Stage`.
    + Datasets have as many rows as there are 
    sampled units (e.g., people) and as many 
    columns as there are variables measured on the sampled units.
* The `with()` function takes a dataset as its first
argument and the summary to compute as its second.
    + In the above example, the summary is a table of the 
    values of the `Gender` variable in the `Mungan` dataset.
* The `table()` function tabulates the unique values
of a variable, or, if given two variables, 
cross-tabulates the two variables (more on 
cross-tabulation in Chapter 15).
    
## Tables, cont.

* Joint frequency distribution of two categorical variables:
```{r,echo=TRUE}
with(Mungan,table(Gender,Cancer.Stage))
```

## Example Histogram

* Data on the numbers of hysterectomies performed by 15 male Swiss doctors:    
\footnotesize `20 25 25 27 28 31 33 34 36 37 44 50 59 85 86`

\footnotesize

```{r,results='asis',fig.height=2.3,fig.width=3.4,message=FALSE,warning=FALSE}
hyst <- data.frame(numHyster = c(20,25,25,27,28,31,33,34,
                                 36,37,44,50,59,85,86))
library(ggplot2)
ggplot(hyst,aes(x=numHyster)) + geom_histogram(binwidth=10)
```

## Software Notes: Data Frames

* We used the `data.frame()` function to create a data frame
with a single variable `numHyster`.
    + Data frames are objects used to store datasets in R.
    + Typically a data frame consists of multiple variables,
    such as the `Mungan` data frame with variables
    `Gender` and `Cancer.Stage`.
    + Use `names()` to find the names of variables in 
    a data frame:


\small

```{r}
names(Mungan)
```
    
    
## Software Notes: Add-on Packages

* The code chunk that draws the histogram
loads an add-on package for R. 
* R consists of a "base" distribution plus
many add-on packages that contain useful functions.
    + For example, 
    `ggplot2` is a package that contains the 
    graphics function `ggplot()`.
* To use the functions in a package you 
must **first** load the package with `library()`.
    + For example, `library(ggplot2)` loads
    `ggplot2` and gives us access to `ggplot()`.
* If you don't load a package, R can't find its
functions. 
    + For example, if you haven't yet loaded
    `ggplot2` and you try to use `ggplot()`
    you will get an error message:

\scriptsize

```
Error: could not find function "ggplot"
```

## Software Notes: Installing Add-on Packages


* See the video https://www.youtube.com/watch?v=CtOSryChcGg
for more on R packages. 
* RStudio users (RStudio Desktop or RStudio Cloud)
will need to install the packages they need. 
    + RStudio Desktop users should consult the 
    **R Packages** section 
    of the getting started document at
    \url{https://github.com/SFUStatgen/RforStat2/blob/master/Tutorials/GettingStarted/startR-RStudio.Rmd}
    + RStudio Cloud users should consult step 5 of the getting
    started document at
    \url{https://github.com/SFUStatgen/RforStat2/blob/master/Tutorials/GettingStarted/startRStudioCloud.Rmd}

* Jupyter should have all the packages we will need for this
course installed.
    + Thus, Jupyter
    users don't need to install
    packages (but **do** need to load them before
    using).


## Software Notes: `ggplot()`

* `ggplot2` is an add-on package for R that implements the
graphics function `ggplot()`.
    + We will use `ggplot()` throughout the course.
* The call was

\scriptsize

```{r, eval=FALSE}
ggplot(hyst,aes(x=numHyster)) + geom_histogram(binwidth=10)
```

\normalsize

* This specifies the dataset (`hyst`) and
the "aesthetic", which is a list of variables to plot as
different features of the graph.
    + This example is a histogram of `numHyster`.
    We specify that `numHyster` 
    is the x-axis variable with `x=numHyster`.
    + The function `geom_histogram()` adds the histogram;
    it takes the bin width as an optional argument.


# Summary Statistics (Chapter 3)

## Centre: The mean

* The mean is the ordinary arithmetic average of the observations.
* Hysterectomy example data: 
```
20 25 25 27 28 31 33 34 36 37 44 50 59 85 86 
```
has mean 
$$
\frac{20+25+\ldots+86}{n}=41.3
$$

\scriptsize

```{r,warning=FALSE,message=FALSE}
library(dplyr)
summarize(hyst,mean(numHyster))
```

## Software Note

* `dplyr` is an add-on package for R that includes useful
tools for manipulating datasets in R.
    + The `summarize()` function takes the dataset as
    its first argument, and the summaries to compute
    as additional arguments.
    + In this example we could have instead used 
    `with(hyst,mean(numHyster))`, but we will
    eventually want to use `summarize()` together
    with other tools from `dplyr` to produce data summaries.

## Centre: The Median

* The median is the ``middle value'' of the variable 

\footnotesize

20, 25, 25, 27, 28, 31, 33, **34**, 36, 37, 44, 50, 59, 85, 86  

\normalsize

* The centre observation is the median, $M=34$.

\scriptsize

```{r}
summarize(hyst,median(numHyster))
```


## Spread: The Standard Deviation (SD) and Variance

* The SD measures spread about the mean.
* The sample variance, $s^2$, can be viewed as the average of the squared 
deviations, and the sample SD, $s$, as its square root.

* Hysterectomy example: $s=20.6$ 

\scriptsize

```{r}
summarize(hyst,sd(numHyster))
```

## Spread: The Inter-Quartile Range (IQR)

* The first and third quartiles mark the first and third quarters of the observations
    + These are also called the 25th and 75th percentile

\scriptsize

```{r}
summarize(hyst,
          Q1=quantile(numHyster,probs=.25),
          Q3=quantile(numHyster,probs=.75))
```

\normalsize

* The middle half of the data lies between. 
* The range of the middle half, or IQR, is 47-27.5=19.5.

\scriptsize

```{r}
summarize(hyst,IQR(numHyster))
```


## Boxplots

* The five number summary is the minimum, maximum, median,
1st and 3rd quartiles. 
* Graphed with a boxplot:

\scriptsize

```{r,fig.height=3,fig.width=4}
with(hyst,boxplot(numHyster)) 
```
